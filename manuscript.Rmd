---
title: Investigating factors that may influence COVID-19 survival
author: 36112985
bibliography: manuscript/bibliography.bib
output:
  rmarkdown::pdf_document:
    keep_tex: FALSE
    citation_package: "default"
    number_sections: FALSE
    extra_dependencies:
      - booktabs
urlcolor: orange
linkcolor: green
citecolor: red
header-includes:
  - \usepackage{color}
  - \usepackage{caption}
  - \captionsetup[figure]{font={normalsize, color=gray}, width=.8\linewidth}
  - \usepackage{xcolor}
  - \usepackage{titlesec}
  - \usepackage{fancyhdr}
  - \newtheorem{theorem}{Theorem}
  - \newtheorem{proposition}[theorem]{Proposition}
  - \newtheorem{remark}{Remark}
  - \newtheorem{definition}{Definition}
  - \definecolor{darkgrey}{HTML}{4a4a4a}
  - \titleformat*{\section}{\Large\color{darkgrey}}
  - \pagestyle{fancy}
---

<!--- Global Settings
    th -> top or here
--->
```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(knitr.table.format = "latex")
```

<!--- imports --->
```{r include = FALSE}
library(xtable)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)


library(magrittr)
library(latex2exp)
library(survival)
library(patchwork)
```

<!--- external functios --->
```{r}
sys.source(file = 'R/evaluation/KaplanMeier.R', envir = knitr::knit_global())
sys.source(file = 'R/functions/StudyData.R', envir = knitr::knit_global())

sys.source(file = 'R/background/Numbers.R', envir = knitr::knit_global())
```

```{r}
data <- StudyData()
```

> # ABSTRACT
>
> **Objective** *To investigate, amongst a set of probable prognostic factors, which factors may influence coronavirus 19 disease survival probabilities.*
>
> **Design** *Prospective cohort study; ongoing.*
>
> **Setting** *The International Severe Acute Respiratory and Emerging Infections Consortium (ISARIC) World Health Organization (WHO) Clinical Characterisation Protocol UK (CCP-UK) study, which enrols in-patients at at-least 260 England, Scotland, and Wales hospitals; the ISARIC Coronavirus Clinical Characterisation Consortium (ISARIC 4C) conducts the study. The investigation's patients are patients enrolled in a participating England hospital between 10 February 2020 and 5 July 2020.*
>
> **Participants** *Each study enrollee has a confirmed SARS-CoV-2 infection, or a high infection likelihood.  The investigation's patients are members of age groups *30 - 39*, *40 - 49*, and higher.*
>
> **Outcome** Patient survival.
>
> **Results** Inconclusive.
>
> **Conclusions**  Insufficient spectrum of factors.

# Introduction

During the past 2 years, infections due to severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) have led to a high number of coronavirus 19 disease deaths and in-hospital care.  With time, case fatality rates, and in-hospital survival rates, have improved [...] as our understanding of coronavirus 19 disease pathogenesis has developed.  Consequently,  disease prevention, mitigation, and treatment measures have improved.

Effective disease treatment measures depend on our understanding of the disease's prognosis factors [@riley2013], the focus of prognostic factors research.  Prognostic factor research *aims to identify factors associated with subsequent clinical outcome in people with a particular disease or health condition* [@riley2013].

This brief investigates the prognostic factor potential of a set of measures associated with a prospective cohort study. The study's hypothesis is that *one or more of the measures has a significant impact on each patient's survival probability*.  The ISARIC 4C study outcomes are: discharged alive, remains in hospital, death, transferred, and palliative discharge. Herein, the overarching outcomes of interest are: dead, alive.  The predictors, factors, under investigation

# Methods

## Study design and setting

This investigation's data is an indirect ISARIC (International Severe Acute Respiratory Infection Consortium)  4C (Coronavirus Clinical Characterisation Consortium) study data set.  The study is an ongoing prospective cohort study based in more than 200 United Kingdom acute care hospitals.  This investigation's data is an England only data set.  The reporting ...

\vspace{20pt}

## Participants

Inclusion criteria were people of all ages who were admitted to one of 208 acute care hospitals in England, Scotland, and Wales with proven or high likelihood of infection with a pathogen of public health interest, defined as SARS-CoV-2 for this event by Public Health England. Reverse transcriptase polymerase chain reaction was the only mode of testing available during the period of study. The decision to test was at the discretion of the clinician attending the patient, and not defined by protocol. The enrolment criterion “high likelihood of infection” reflects that a preparedness protocol cannot assume that a diagnostic test will be available for an emergent pathogen. Site training emphasises that only patients who tested positive for covid-19 were eligible for enrolment.

National guidance was provided by Public Health England and other UK public health agencies that advised who to test based on clinical case definitions for possible covid-19. We also included patients who had been admitted for a separate condition but had tested positive for covid-19 during their hospital stay. Patients were only enrolled during their index admission. Patients had clinical information from their routine health records uploaded into the case report form. Consent was not required for collection of depersonalised routine healthcare data for research in England and Wales. A waiver for consent was given by the Public Benefit and Privacy Panel in Scotland.

\vspace{20pt}

## Data

Although the consortium collects a large variety of demographic, clinical, and outcome data, this investigation's data only included a limited subset of the study's variables.  The demographic data variables are sex and age group, the comorbidity variables are asthma (physician diagnosed), mild liver disease, moderate/severe liver disease, renal disease, chronic pulmonary disease (excluding asthma), chronic neurological disorder, malignant neoplasm.

The ISARIC 4C study collects its baseline data via paper case report forms developed by ISARIC, and the WHO (World Health Organization), for outbreak investigations.  Additionally, the data brief states that the baseline data records are *uploaded [on] admission, and usually before hospital episodes were complete, to a REDCap database (Research Electronic Data Capture, Vanderbilt University, US, hosted by University of Oxford, UK).*

\vspace{20pt}

## Exploratory Data Analysis

* Relationships
* Correlations

\vspace{20pt}

## Missing Data

Most of the data's variables have missing values.  Prior to deciding how to address missing values, it is important to understand the missing values patterns [@steyerberg2010]. Rubin [@rubin1976, @steyerberg2010, @little2019] outlines three fundamental missing data mechanisms

* missing completely at random (MCAR) / administrative errors, accidents
* missing at random (MAR) / missing data associated with known patient characteristics [independent variables], or the outcome
* missing not at random (MNAR) / missing data associated with missing values of the factor/predictor in question or with unobserved predictors

If the missing values of a data set in question are *missing completely at random* then complete case analysis will suffice because the complete case excerpt is akin to a random sample from a complete population.  If MCAR does not hold, e.g., data is *missing at random*, then the complete case excerpt is not representative of the underlying population, therefore population inference is not possible via complete case analysis. [@steyerberg2010]

Herein, missing data mechanisms analysis is via logistic regression.  Almost all the independent variables have missing values patterns that violate MCAR; addressed via multiple imputation in-line with the advice and protocols of [@sterne2009] & [@steyerberg2010].


## Factor Analysis

The Cox Hazard, Restricted Mean Survival

\vspace{20pt}


# Results

## Characteristics

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.25}
    \begin{tabular}{l r r r}
    & & & \\
    \textbf{In Hospital Mortality} & & & \\
    \hline
     & \textbf{no} & \textbf{yes} & \textbf{NA} \\
    deceased & 31724 & 14049 & 347 \\
     & 0.688 & 0.305 & 0.008 \\
     & & & \\
    \textbf{Comorbidities} & & & \\
    \hline
     & \textbf{no} & \textbf{yes} & \textbf{NA} \\
    asthma & 37376 & 5872 & 2872 \\
    & 0.81 & 0.13 & 0.06 \\
    mild liver disease & 42021 & 666 & 3433 \\
     & 0.91 & 0.01 & 0.07 \\
    renal disease & 35158 & 8056 & 2906 \\
     & 0.76 & 0.17 & 0.06 \\
    pulmonary & 35265 & 8078 & 2777 \\
     & 0.76 & 0.18 & 0.06 \\
    neurological disorder & 37227 & 5806 & 3087 \\
     & 0.81 & 0.13 & 0.07 \\
    liver mod severe &  41901 &  902 & 3317 \\
     & 0.91 & 0.02 & 0.07 \\
    malignant neoplasm & 38164 & 4734 & 3222 \\
     & 0.83 & 0.10 & 0.07 \\
     & & & \\
    \textbf{Demographics} & & & \\
    \hline
    \textbf{Age Group} &  \textbf{Male} & \textbf{Female} & \textbf{NA} \\
    80-89 & 7067 & 6197 & 31 \\
    & 0.153 & 0.134 & 0.001 \\
    70-79 & 6388 & 4445 & 19 \\
    & 0.139 & 0.096 & 0.000 \\
    60-69 & 4321 & 2601 & 9 \\
    & 0.094 & 0.056 & 0.000 \\
    50-59 & 3463 & 2151 & 9 \\
    & 0.075 & 0.047 & 0.000 \\
    90+ & 2085 & 2816 & 13 \\
    & 0.045 & 0.061 & 0.000 \\
    40-49 & 1846 & 1110 & 5 \\
    & 0.040 & 0.024 & 0.000 \\
    30-39 & 784 & 756 & 4 \\
    & 0.017 & 0.016 & 0.000 \\
    \hline
    \end{tabular}
\end{table}


## The Null Kaplan-Meier Curves

```{r fig.height = 3.5, fig.align = 'center', warning = FALSE, message = FALSE, fig.cap = "The null survival curves, whereby (A) is based on complete cases only, whilst (B) is based on all plausible records after multiple imputation."}
KaplanMeier()
```









## Null Survival Curve

* Complete Case
* Imputation Case

## Uni-variate & Multivariate Analysis

* The table ... Cox

## Adjusted Analysis via Restricted Mean Survival Time

The proportional hazard assumption does not hold ...



# Discussion

## The Cox Model Assumptions

**The observations are independent**: This assumption requires a set of observations wherein the patients are not related or associated.  If there are clusters of relations or associates, the clusters should be, must be, indicated as-such.   By virtue of the > study's design, it is quite possible that the observations are not independent - families, friends, and colleagues living in the same area will probably be admitted to the same health centre.   Alas, the data set does not have cluster indicators, hence it is impossible to definitively test and state the independence, or otherwise, of the observations.

**Independent Censoring**:  There is neither evidence to suggest nor rule-out <span style="color: brown;">outcomes due to systematic drop-outs, induced by study design flaws</span>.  What are the prognosis of patients released to palliative care or transferred?  Is the decision to transfer or release to palliative care influenced or dictated by *lower* survival probability?  If the answer to the latter question is yes - it will be in breach of independent censoring.

**Proportional Hazards**: The curves.

## Missing Data

Within a missing values setting, there are 2 options w.r.t. predictor effect analysis [@steyerberg2010]

* complete case analysis for the uni-variate analysis, and complete case predictors & imputed confounding variables for adjusted analysis.
* uni-variate and adjusted analysis after imputation of all missing values.

The investigation opted for the latter, especially because ...

## Bias

Possible bias points

* By virtue of the study's design pre-study--admission differences between hospitals is possible due to the ambiguity of the study's patient recruitment terms, and this might lead to post-study differences.  In a nutshell, the study is susceptible to selection bias. [Trochim]

* Missing data [@sterne2009]


# Conclusion

The analysis of missing values hints at flaws in data collection.


\appendix

\section{Appendices}

\subsection{Exploratory Analysis}

```{r}

```

Graphs

\subsection{Missing Data}

Clusters, patterns, associations.


<!--- # References {#references .unnumbered} --->
# References


